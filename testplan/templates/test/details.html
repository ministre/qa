{% extends "device/wrapper.html" %}

{% load i18n static %}

{% block content %}

<p><a href="{% url 'testplans' %}">{% trans "Testplan" %}</a> &raquo;
    <a href="{% url 'testplan_details' testplan_id=testplan.id %}">{{ testplan.name}}</a> &raquo;
    <a href="{% url 'testplan_details' testplan_id=testplan.id %}">{{ test.category }}</a> &raquo;
    {{ test.name }}
</p>

<ul class="tabs" data-tabs id="example-tabs">
    <li class="tabs-title is-active"><a href="#panel1" aria-selected="true">{% trans "Info" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel2" href="#panel2">{% trans "Procedure" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel3" href="#panel3">{% trans "Expected result" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel4" href="#panel4">{% trans "Configuration" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel5" href="#panel5">{% trans "Images" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel6" href="#panel6">{% trans "Files" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel7" href="#panel7">{% trans "Checklists" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel8" href="#panel8">{% trans "Worksheets" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel9" href="#panel9">{% trans "Links" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel10" href="#panel10">{% trans "Comments" %}</a></li>
    <li class="tabs-title"><a data-tabs-target="panel11" href="#panel11">{% trans "Redmine" %}</a></li>
</ul>

<div class="tabs-content" data-tabs-content="example-tabs">
  <div class="tabs-panel is-active" id="panel1">
        <table class="hover unstriped">
            <tbody>
            <tr>
                <td>{% trans "Category" %}:</td>
                <td>{{ test.category.name }}</td>
            </tr>
            <tr>
                <td>{% trans "Test name" %}:</td>
                <td>{{ test.name }}</td>
            </tr>
            <tr>
                <td>{% trans "Purpose" %}:</td>
                <td>{{ test.purpose }}</td>
            </tr>
            <tr>
                <td>{% trans "Created by" %}:</td>
                <td>{{ test.created_by }}</td>
            </tr>
            <tr>
                <td>{% trans "Created at" %}:</td>
                <td>{{ test.created_at }}</td>
            </tr>
            <tr>
                <td>{% trans "Updated by" %}:</td>
                <td>{{ test.updated_by }}</td>
            </tr>
            <tr>
                <td>{% trans "Updated at" %}:</td>
                <td>{{ test.updated_at }}</td>
            </tr>
            </tbody>
        </table>
  </div>

  <div class="tabs-panel" id="panel2">
    <p>{{ test_procedure|safe }}</p>
  </div>

  <div class="tabs-panel" id="panel3">
    <p>{{ test_expected|safe }}</p>
  </div>

  <div class="tabs-panel" id="panel4">
      <a href="{% url 'test_config_create' testplan_id=testplan.id test_id=test.id %}" class="button small">Add Configuration</a>
      {% for config in configs %}
      {% if config.name %}<p>{{ config.name }}</p>{% endif %}
      <pre><code data-language="{{ config.lang }}">
{{ config.config }}
      </code></pre>
      <a href="{% url 'test_config_update' testplan_id=testplan.id test_id=test.id pk=config.id %}" class="button small">Update</a>
      <a href="{% url 'test_config_delete' testplan_id=testplan.id test_id=test.id pk=config.id %}" class="button small alert">Delete</a>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel5">
      <a href="{% url 'test_image_create' testplan_id=testplan.id test_id=test.id %}" class="button small">Add Image</a>
      {% for image in images %}
      <p>{{ image.name }}</p>
      <p><img src="{{ image.image.url }}"></p>
      <a href="{% url 'test_image_update' testplan_id=testplan.id test_id=test.id pk=image.id %}" class="button small">Update</a>
      <a href="{% url 'test_image_delete' testplan_id=testplan.id test_id=test.id pk=image.id %}" class="button small alert">Delete</a>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel6">
      <a href="{% url 'test_file_create' testplan_id=testplan.id test_id=test.id %}" class="button small">Add File</a>
      {% for file in files %}
      <p><a href="{{ file.file.url }}">{{ file.name }}</a></p>
      <a href="{% url 'test_file_update' testplan_id=testplan.id test_id=test.id pk=file.id %}" class="button small">Update</a>
      <a href="{% url 'test_file_delete' testplan_id=testplan.id test_id=test.id pk=file.id %}" class="button small alert">Delete</a>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel7">
      <a href="{% url 'test_checklist_create' testplan_id=testplan.id test_id=test.id %}" class="button small">Add Checklist</a>
      {% for checklist in checklists %}
      <ul style="list-style: none">
          <li>
              <b>{{ checklist.name }}</b>
              <a href="{% url 'test_checklist_update' testplan_id=testplan.id test_id=test.id pk=checklist.id %}">
                  <i class="step fi-pencil"></i></a>
              <a href="{% url 'test_checklist_delete' testplan_id=testplan.id test_id=test.id pk=checklist.id %}">
                  <i class="step fi-minus" style="color: #bc104b"></i></a>
              {% for item in checklist.items %}
              <ul style="list-style: none">
                  <li>
                      <i class="fi-checkbox"></i> {{ item.name }}
                      <a href="{% url 'checklist_item_update' testplan_id=testplan.id test_id=test.id pk=item.id %}">
                          <i class="step fi-pencil"></i></a>
                      <a href="{% url 'checklist_item_delete' testplan_id=testplan.id test_id=test.id pk=item.id %}">
                          <i class="step fi-minus" style="color: #bc104b"></i></a>
                  </li>
              </ul>
              {% endfor %}
              <blockquote>
                  <a href="{% url 'checklist_item_create' testplan_id=testplan.id test_id=test.id checklist_id=checklist.id %}">
                  <i class="step fi-plus"></i></a>
              </blockquote>

          </li>
      </ul>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel8">
      <a href="{% url 'test_worksheet_create' testplan_id=testplan.id test_id=test.id %}" class="button small">Add Worksheet</a>
      {% for worksheet in worksheets %}
      <ul style="list-style: none">
          <li>
              <b>{{ worksheet.name }}</b>
              <a href="{% url 'test_worksheet_update' testplan_id=testplan.id test_id=test.id pk=worksheet.id %}">
                  <i class="step fi-pencil"></i></a>
              <a href="{% url 'test_worksheet_delete' testplan_id=testplan.id test_id=test.id pk=worksheet.id %}">
                  <i class="step fi-minus" style="color: #bc104b"></i></a>
              {% for item in worksheet.items %}
              <ul style="list-style: none">
                  <li>
                      <i class="fi-checkbox"></i> {{ item.name }}
                      <a href="{% url 'worksheet_item_update' testplan_id=testplan.id test_id=test.id pk=item.id %}">
                          <i class="step fi-pencil"></i></a>
                      <a href="{% url 'worksheet_item_delete' testplan_id=testplan.id test_id=test.id pk=item.id %}">
                          <i class="step fi-minus" style="color: #bc104b"></i></a>
                  </li>
              </ul>
              {% endfor %}
              <blockquote>
                  <a href="{% url 'worksheet_item_create' testplan_id=testplan.id test_id=test.id worksheet_id=worksheet.id %}">
                  <i class="step fi-plus"></i></a>
              </blockquote>

          </li>
      </ul>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel9">
      <a href="{% url 'test_link_create' testplan_id=testplan.id test_id=test.id %}" class="button small">Add Link</a>
      {% for link in links %}
      <p><a href="{{ link.url }}">{{ link.name }}</a></p>
      <a href="{% url 'test_link_update' testplan_id=testplan.id test_id=test.id pk=link.id %}" class="button small">Update</a>
      <a href="{% url 'test_link_delete' testplan_id=testplan.id test_id=test.id pk=link.id %}" class="button small alert">Delete</a>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel10">
      <a href="{% url 'test_comment_create' testplan_id=testplan.id test_id=test.id %}" class="button small">{% trans "Add Comment" %}</a>
      {% for comment in comments %}
      <p>{{ comment.text }}</p>
      <a href="{% url 'test_comment_update' testplan_id=testplan.id test_id=test.id pk=comment.id %}" class="button small">
          {% trans "Update" %}</a>
      <a href="{% url 'test_comment_delete' testplan_id=testplan.id test_id=test.id pk=comment.id %}" class="button small alert">
          {% trans "Delete" %}</a>
      {% endfor %}
  </div>

  <div class="tabs-panel" id="panel11">
      <table class="hover unstriped">
          <tbody>
          <tr>
              <td>{% trans "Redmine URL" %}:</td>
              <td>{{ test.redmine_url }}</td>
          </tr>
          </tbody>
      </table>

      <form method="post" action="/redmine/import_test_details/">
          {% csrf_token %}
          <input type="hidden" name="test_id" value="{{ test.id }}">
          <input type="hidden" name="testplan_id" value="{{ testplan.id }}">
          <input type="hidden" name="redmine_url" value="{{ test.redmine_url }}">
          <input type="hidden" name="tag" value="{{ testplan.device_type.tag }}">
          <input type="submit" value='{% trans "Update from Redmine" %}' class="button success small" />
      </form>

  </div>
</div>

<script src="{% static 'rainbow/rainbow-custom.min.js' %}"></script>

{% endblock %}